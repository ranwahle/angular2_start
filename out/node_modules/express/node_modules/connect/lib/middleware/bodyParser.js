System.registerModule("../../../../../../../node_modules/express/node_modules/connect/lib/middleware/bodyParser.js", [], function() {
  "use strict";
  var __moduleName = "../../../../../../../node_modules/express/node_modules/connect/lib/middleware/bodyParser.js";
  var qs = require('qs'),
      formidable = require('formidable');
  function mime(req) {
    var str = req.headers['content-type'] || '';
    return str.split(';')[0];
  }
  exports = module.exports = function bodyParser(options) {
    options = options || {};
    return function bodyParser(req, res, next) {
      if (req.body)
        return next();
      req.body = {};
      if ('GET' == req.method || 'HEAD' == req.method)
        return next();
      var parser = exports.parse[mime(req)];
      if (parser) {
        parser(req, options, next);
      } else {
        next();
      }
    };
  };
  exports.parse = {};
  exports.parse['application/x-www-form-urlencoded'] = function(req, options, fn) {
    var buf = '';
    req.setEncoding('utf8');
    req.on('data', function(chunk) {
      buf += chunk;
    });
    req.on('end', function() {
      try {
        req.body = buf.length ? qs.parse(buf) : {};
        fn();
      } catch (err) {
        fn(err);
      }
    });
  };
  exports.parse['application/json'] = function(req, options, fn) {
    var buf = '';
    req.setEncoding('utf8');
    req.on('data', function(chunk) {
      buf += chunk;
    });
    req.on('end', function() {
      try {
        req.body = buf.length ? JSON.parse(buf) : {};
        fn();
      } catch (err) {
        fn(err);
      }
    });
  };
  exports.parse['multipart/form-data'] = function(req, options, fn) {
    var form = new formidable.IncomingForm,
        data = {},
        files = {},
        done;
    Object.keys(options).forEach(function(key) {
      form[key] = options[key];
    });
    function ondata(name, val, data) {
      if (Array.isArray(data[name])) {
        data[name].push(val);
      } else if (data[name]) {
        data[name] = [data[name], val];
      } else {
        data[name] = val;
      }
    }
    form.on('field', function(name, val) {
      ondata(name, val, data);
    });
    form.on('file', function(name, val) {
      ondata(name, val, files);
    });
    form.on('error', function(err) {
      fn(err);
      done = true;
    });
    form.on('end', function() {
      if (done)
        return;
      try {
        req.body = qs.parse(data);
        req.files = qs.parse(files);
        fn();
      } catch (err) {
        fn(err);
      }
    });
    form.parse(req);
  };
  return {};
});
System.get("../../../../../../../node_modules/express/node_modules/connect/lib/middleware/bodyParser.js" + '');
